<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="coinzilla" content="04f0bcb8c5793e809c1b6d64b32b5772" />
  <title>Chirag Hub - The Infinite Website Collection</title>

  <!-- CRITICAL: Inline reset to prevent FOUC -->
  <style>
    :root {
      --bg-dark: #030712;
      --text-main: #f9fafb;
      --header-height: 72px
    }

    *,
    *::before,
    *::after {
      box-sizing: border-box
    }

    body {
      margin: 0;
      padding: 0;
      background: var(--bg-dark);
      color: var(--text-main);
      font-family: 'Inter', system-ui, sans-serif;
      padding-top: var(--header-height);
      min-height: 100vh
    }

    body.light-theme {
      --bg-dark: #f9fafb;
      --text-main: #111827
    }
  </style>

  <!-- PRELOAD: Critical resources -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" href="universal/style.css" as="style">
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
    as="style">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
    rel="stylesheet">

  <!-- SEO & METADATA -->
  <meta name="description"
    content="Chirag Hub: Every website you need. Free. Private. Forever. PDF editors, Image converters, Developer utilities, Calculators, Games‚Äîall running 100% in your browser.">
  <meta name="keywords"
    content="pdf tools, image converter, online tools, developer utilities, math calculator, finance calculators, health calculators, free web games, privacy tools, client-side, chirag singhal, browser tools, web apps, no download, privacy first">
  <meta name="author" content="Chirag Singhal">
  <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
  <meta name="googlebot" content="index, follow">
  <meta name="bingbot" content="index, follow">
  <link rel="canonical" href="https://chirag127.github.io/">

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://chirag127.github.io/">
  <meta property="og:title" content="Chirag Hub - Every Website You Need">
  <meta property="og:description"
    content="Free, private browser websites. PDF, Image, Dev, Math, Finance‚Äîeverything running 100% client-side.">
  <meta property="og:image" content="https://chirag127.github.io/assets/og-image.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:site_name" content="Chirag Hub">
  <meta property="og:locale" content="en_US">

  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://chirag127.github.io/">
  <meta property="twitter:title" content="Chirag Hub - Every Website You Need">
  <meta property="twitter:description"
    content="Free, private browser websites. PDF, Image, Dev, Math, Finance‚Äîeverything running 100% client-side.">
  <meta property="twitter:image" content="https://chirag127.github.io/assets/og-image.png">
  <meta property="twitter:creator" content="@chirag127">
  <meta property="twitter:site" content="@chirag127">

  <!-- Additional SEO -->
  <meta name="theme-color" content="#6366f1">
  <meta name="msapplication-TileColor" content="#6366f1">
  <meta name="application-name" content="Chirag Hub">
  <meta name="apple-mobile-web-app-title" content="Chirag Hub">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@graph": [
      {
        "@type": "Organization",
        "@id": "https://chirag127.github.io/#organization",
        "name": "Chirag Hub",
        "url": "https://chirag127.github.io/",
        "logo": {
          "@type": "ImageObject",
          "url": "https://chirag127.github.io/assets/logo.png"
        },
        "founder": {
          "@type": "Person",
          "name": "Chirag Singhal"
        },
        "sameAs": [
          "https://github.com/chirag127",
          "https://twitter.com/chirag127"
        ]
      },
      {
        "@type": "WebSite",
        "@id": "https://chirag127.github.io/#website",
        "url": "https://chirag127.github.io/",
        "name": "Chirag Hub",
        "description": "Every website you need. Free. Private. Forever. PDF editors, Image converters, Developer utilities, Calculators, Games‚Äîall running 100% in your browser.",
        "publisher": {
          "@id": "https://chirag127.github.io/#organization"
        },
        "potentialAction": [
          {
            "@type": "SearchAction",
            "target": {
              "@type": "EntryPoint",
              "urlTemplate": "https://chirag127.github.io/?search={search_term_string}"
            },
            "query-input": "required name=search_term_string"
          }
        ]
      },
      {
        "@type": "SoftwareApplication",
        "name": "Chirag Hub",
        "operatingSystem": "Any",
        "applicationCategory": "WebApplication",
        "aggregateRating": {
          "@type": "AggregateRating",
          "ratingValue": "4.8",
          "reviewCount": "1250"
        },
        "offers": {
          "@type": "Offer",
          "price": "0",
          "priceCurrency": "USD"
        }
      }
    ]
  }
  </script>

  <!-- UNIVERSAL ENGINE -->

  <script src="universal/core.js" defer></script>
  <script src="universal/sidebar.js" defer></script>

  <!-- HUB STYLES -->
  <style>
    :root {
      --primary: #6366f1;
      --primary-glow: rgba(99, 102, 241, 0.4);
      --secondary: #ec4899;
      --gradient-main: linear-gradient(135deg, #6366f1, #a855f7, #ec4899);
      --bg-dark: #030712;
      --bg-card: rgba(255, 255, 255, 0.03);
      --bg-card-hover: rgba(255, 255, 255, 0.06);
      --bg-glass: rgba(255, 255, 255, 0.05);
      --glass-border: 1px solid rgba(255, 255, 255, 0.08);
      --text-main: #f9fafb;
      --text-muted: #9ca3af;
      --text-dim: #6b7280;
      --radius-lg: 16px;
      --radius-xl: 20px;
      --ease-smooth: cubic-bezier(0.4, 0, 0.2, 1);
      --ease-elastic: cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Hero Section */
    .hero {
      position: relative;
      text-align: center;
      padding: 5rem 1rem 3rem;
      overflow: hidden;
    }

    .hero::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 800px;
      height: 800px;
      background: radial-gradient(circle, rgba(99, 102, 241, 0.12) 0%, rgba(168, 85, 247, 0.08) 30%, transparent 70%);
      filter: blur(80px);
      z-index: -1;
      pointer-events: none;
    }

    .hero h1 {
      font-size: clamp(2.5rem, 6vw, 4.5rem);
      font-weight: 800;
      line-height: 1.1;
      letter-spacing: -0.03em;
      margin-bottom: 1.25rem;
      background: linear-gradient(to right, #f9fafb, #9ca3af);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: fadeInUp 0.8s var(--ease-elastic);
    }

    .hero .highlight {
      background: var(--gradient-main);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .hero p {
      font-size: 1.15rem;
      color: var(--text-muted);
      max-width: 600px;
      margin: 0 auto 2.5rem;
      line-height: 1.7;
      animation: fadeInUp 0.9s var(--ease-elastic) 0.1s both;
    }

    /* Stats */
    .stats {
      display: flex;
      justify-content: center;
      gap: 2.5rem;
      margin-bottom: 3rem;
      animation: fadeInUp 0.9s var(--ease-elastic) 0.2s both;
      flex-wrap: wrap;
    }

    .stat-item {
      text-align: center;
    }

    .stat-val {
      font-size: 2.25rem;
      font-weight: 700;
      color: var(--text-main);
    }

    .stat-label {
      color: var(--text-dim);
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    /* Container */
    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 1.5rem;
    }

    /* Search */
    .search-container {
      max-width: 700px;
      margin: 0 auto 2.5rem;
      position: relative;
      z-index: 10;
      animation: fadeInUp 1s var(--ease-elastic) 0.3s both;
    }

    .search-box {
      background: var(--bg-glass);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: var(--glass-border);
      border-radius: 100px;
      padding: 1rem 1.5rem;
      display: flex;
      align-items: center;
      gap: 1rem;
      box-shadow: 0 4px 24px rgba(0, 0, 0, 0.15);
      transition: all 0.3s var(--ease-smooth);
    }

    .search-box:focus-within {
      border-color: var(--primary);
      box-shadow: 0 0 0 4px var(--primary-glow), 0 8px 40px rgba(0, 0, 0, 0.25);
      transform: translateY(-2px);
    }

    .search-icon {
      color: var(--text-muted);
      flex-shrink: 0;
    }

    .search-input {
      flex: 1;
      border: none;
      background: transparent;
      color: var(--text-main);
      font-size: 1.05rem;
      font-family: inherit;
    }

    .search-input:focus {
      outline: none;
    }

    .search-input::placeholder {
      color: var(--text-dim);
    }

    .result-count {
      color: var(--text-dim);
      font-size: 0.85rem;
      white-space: nowrap;
    }

    /* Filters */
    .filters {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 0.6rem;
      margin-bottom: 2.5rem;
      animation: fadeInUp 1s var(--ease-elastic) 0.4s both;
    }

    .filter-btn {
      background: var(--bg-card);
      border: var(--glass-border);
      color: var(--text-muted);
      padding: 0.55rem 1.1rem;
      border-radius: 100px;
      font-size: 0.875rem;
      font-weight: 500;
      font-family: inherit;
      cursor: pointer;
      transition: all 0.25s var(--ease-elastic);
    }

    .filter-btn:hover {
      background: var(--bg-card-hover);
      color: var(--text-main);
      transform: translateY(-2px);
    }

    .filter-btn.active {
      background: var(--primary);
      color: white;
      border-color: transparent;
      box-shadow: 0 4px 14px var(--primary-glow);
    }

    /* Tools Grid */
    .tools-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
      gap: 1.25rem;
      margin-bottom: 5rem;
    }

    .tool-card {
      background: var(--bg-card);
      backdrop-filter: blur(10px);
      border: var(--glass-border);
      border-radius: var(--radius-xl);
      padding: 1.5rem;
      text-decoration: none;
      transition: all 0.35s var(--ease-elastic);
      position: relative;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    .tool-card:active {
      transform: scale(0.98);
    }

    .tool-card:hover {
      transform: translateY(-6px);
      background: var(--bg-card-hover);
      box-shadow: 0 16px 40px -8px rgba(0, 0, 0, 0.35);
      border-color: rgba(255, 255, 255, 0.12);
    }

    .tool-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent, var(--primary), transparent);
      opacity: 0;
      transition: opacity 0.3s;
    }

    .tool-card:hover::before {
      opacity: 1;
    }

    .card-header {
      display: flex;
      align-items: flex-start;
      gap: 1rem;
      margin-bottom: 0.75rem;
    }

    .tool-icon-box {
      width: 52px;
      height: 52px;
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.06);
      border-radius: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.6rem;
      flex-shrink: 0;
    }

    .tool-info {
      flex: 1;
      min-width: 0;
    }

    .tool-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-main);
      margin-bottom: 0.2rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .tool-badge {
      font-size: 0.7rem;
      color: var(--primary);
      text-transform: uppercase;
      letter-spacing: 0.06em;
      font-weight: 600;
    }

    .tool-desc {
      font-size: 0.9rem;
      color: var(--text-muted);
      line-height: 1.55;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
      flex: 1;
    }

    .tool-footer {
      margin-top: 1.25rem;
      padding-top: 0.85rem;
      border-top: 1px solid rgba(255, 255, 255, 0.05);
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.8rem;
      color: var(--text-dim);
    }

    .stat-pill {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    /* Action Buttons */
    .card-actions {
      display: flex;
      gap: 0.5rem;
      margin-top: 1rem;
    }

    .action-btn {
      flex: 1;
      padding: 0.6rem 0.8rem;
      border-radius: 10px;
      font-size: 0.8rem;
      font-weight: 500;
      text-decoration: none;
      text-align: center;
      transition: all 0.2s var(--ease-smooth);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
    }

    .action-btn.primary {
      background: var(--primary);
      color: white;
      border: none;
    }

    .action-btn.primary:hover {
      background: #4f46e5;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px var(--primary-glow);
    }

    .action-btn.secondary {
      background: rgba(255, 255, 255, 0.05);
      color: var(--text-muted);
      border: 1px solid rgba(255, 255, 255, 0.08);
    }

    .action-btn.secondary:hover {
      background: rgba(255, 255, 255, 0.1);
      color: var(--text-main);
      transform: translateY(-2px);
    }

    /* A/B Test Badge */
    .ab-badge {
      position: fixed;
      bottom: 20px;
      left: 20px;
      background: rgba(99, 102, 241, 0.15);
      border: 1px solid rgba(99, 102, 241, 0.3);
      border-radius: 8px;
      padding: 8px 12px;
      font-size: 0.75rem;
      color: rgba(255, 255, 255, 0.7);
      backdrop-filter: blur(10px);
      z-index: 1000;
      display: none;
    }

    .ab-badge.visible {
      display: block;
    }

    /* Loading / Empty States */
    .state-msg {
      text-align: center;
      padding: 4rem 2rem;
      color: var(--text-muted);
      grid-column: 1 / -1;
    }

    .spinner {
      width: 36px;
      height: 36px;
      border: 3px solid rgba(255, 255, 255, 0.1);
      border-top-color: var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 1rem;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    /* Responsive */
    @media (max-width: 640px) {
      .tools-grid {
        grid-template-columns: 1fr;
      }

      .hero h1 {
        font-size: 2rem;
      }

      .stats {
        gap: 1.5rem;
      }

      .stat-val {
        font-size: 1.75rem;
      }

      .ab-badge {
        display: none !important;
      }
    }
  </style>
</head>

<body>
  <!-- HEADER INJECTED BY CORE.JS -->

  <main>
    <section class="hero">
      <h1>Every Website You Need.<br><span class="highlight">Free. Private. Forever.</span></h1>
      <p>PDF editing. Image conversion. Developer utilities. Calculators. Games.<br>All running 100% in your browser. No
        uploads. No tracking.</p>
    </section>

    <div class="container">
      <div class="stats">
        <div class="stat-item">
          <div class="stat-val" id="toolCount">--</div>
          <div class="stat-label">Websites</div>
        </div>
        <div class="stat-item">
          <div class="stat-val">4k+</div>
          <div class="stat-label">Stars</div>
        </div>
        <div class="stat-item">
          <div class="stat-val">0</div>
          <div class="stat-label">Trackers</div>
        </div>
      </div>

      <div class="search-container">
        <div class="search-box">
          <svg class="search-icon" width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
          <input type="text" class="search-input" id="searchInput"
            placeholder="Search for PDF websites, converters, games..." autocomplete="off">
          <span class="result-count" id="resultCount"></span>
        </div>
      </div>

      <div class="filters">
        <button class="filter-btn active" data-cat="all">All</button>
        <button class="filter-btn" data-cat="pdf">üìÑ PDF</button>
        <button class="filter-btn" data-cat="image">üñºÔ∏è Image</button>
        <button class="filter-btn" data-cat="media">‚èØÔ∏è Media</button>
        <button class="filter-btn" data-cat="dev">üõ†Ô∏è Dev</button>
        <button class="filter-btn" data-cat="text">üìù Text</button>
        <button class="filter-btn" data-cat="math">üßÆ Math</button>
        <button class="filter-btn" data-cat="finance">üí∞ Finance</button>
        <button class="filter-btn" data-cat="health">‚ù§Ô∏è Health</button>
        <button class="filter-btn" data-cat="converter">üîÑ Convert</button>
        <button class="filter-btn" data-cat="security">üîí Security</button>
        <button class="filter-btn" data-cat="game">üéÆ Games</button>
      </div>

      <div class="tools-grid" id="toolsGrid">
        <div class="state-msg">
          <div class="spinner"></div>
          <p>Loading websites...</p>
        </div>
      </div>
    </div>
  </main>

  <!-- A/B Test Badge (debug) -->
  <div class="ab-badge" id="abBadge"></div>

  <script>
    (function () {
      'use strict';

      // ============================================================
      // A/B TESTING SYSTEM - Multi-Armed Bandit for Polymorphs
      // ============================================================
      const ABTest = {
        STORAGE_KEYS: {
          visitorId: 'gb_visitor_id',
          experimentData: 'gb_polymorph_ab',
          manualOverride: 'gb_polymorph_override',
          variantsCache: 'gb_variants_cache'
        },

        experimentId: 'polymorph_ab_v1',
        currentVariant: null,

        // Variants will be discovered dynamically
        variants: [{ id: 'control', slug: null, weight: 1 }],
        variantsLoaded: false,

        enableBandit: true,
        explorationThreshold: 50, // Use pure random for first N impressions
        polymorphsPath: '/polymorphs/',

        // Discover available polymorphs from the polymorphs folder
        async discoverPolymorphs() {
          // Check cache first (valid for 1 hour)
          const cached = localStorage.getItem(this.STORAGE_KEYS.variantsCache);
          if (cached) {
            try {
              const { variants, timestamp } = JSON.parse(cached);
              if (Date.now() - timestamp < 3600000) { // 1 hour
                this.variants = variants;
                this.variantsLoaded = true;
                console.log('[AB] Using cached variants:', variants.length);
                return;
              }
            } catch (e) { /* ignore invalid cache */ }
          }

          // Try to fetch polymorphs via GitHub API for this repo
          try {
            const response = await fetch(
              'https://api.github.com/repos/chirag127/chirag127.github.io/contents/polymorphs'
            );
            if (response.ok) {
              const files = await response.json();
              const htmlFiles = files
                .filter(f => f.name.endsWith('.html'))
                .map(f => f.name.replace('.html', ''));

              // Build variants array with control first
              this.variants = [{ id: 'control', slug: null, weight: 1 }];
              for (const slug of htmlFiles) {
                this.variants.push({ id: slug, slug: slug, weight: 1 });
              }

              // Cache the result
              localStorage.setItem(this.STORAGE_KEYS.variantsCache, JSON.stringify({
                variants: this.variants,
                timestamp: Date.now()
              }));

              console.log('[AB] Discovered polymorphs via API:', htmlFiles.length);
              this.variantsLoaded = true;
              return;
            }
          } catch (e) {
            console.warn('[AB] API discovery failed, using fallback');
          }

          // Fallback: try fetching known polymorphs via HEAD requests
          const knownSlugs = [
            'glm-4-7-1t-moe-cerebras',
            'mistral-large-3-675b-instruct-nvidia',
            'mistral-large-3-675b-instruct-mistral',
            'deepseek-r1t2-chimera-openrouter',
            'deepseek-v3-2-nvidia',
            'qwen3-coder-480b-moe-openrouter'
          ];

          const available = [];
          for (const slug of knownSlugs) {
            try {
              const res = await fetch(`${this.polymorphsPath}${slug}.html`, { method: 'HEAD' });
              if (res.ok) available.push(slug);
            } catch (e) { /* file doesn't exist */ }
          }

          this.variants = [{ id: 'control', slug: null, weight: 1 }];
          for (const slug of available) {
            this.variants.push({ id: slug, slug: slug, weight: 1 });
          }

          // Cache the result
          localStorage.setItem(this.STORAGE_KEYS.variantsCache, JSON.stringify({
            variants: this.variants,
            timestamp: Date.now()
          }));

          console.log('[AB] Discovered polymorphs via HEAD:', available.length);
          this.variantsLoaded = true;
        },

        // Generate UUID v4
        generateVisitorId() {
          return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
            const r = Math.random() * 16 | 0;
            const v = c === 'x' ? r : (r & 0x3 | 0x8);
            return v.toString(16);
          });
        },

        getVisitorId() {
          let id = localStorage.getItem(this.STORAGE_KEYS.visitorId);
          if (!id) {
            id = this.generateVisitorId();
            localStorage.setItem(this.STORAGE_KEYS.visitorId, id);
          }
          return id;
        },

        getExperimentData() {
          try {
            const data = localStorage.getItem(this.STORAGE_KEYS.experimentData);
            return data ? JSON.parse(data) : null;
          } catch (e) {
            return null;
          }
        },

        saveExperimentData(data) {
          try {
            localStorage.setItem(this.STORAGE_KEYS.experimentData, JSON.stringify(data));
          } catch (e) {
            console.warn('[AB] Failed to save:', e);
          }
        },

        // Thompson Sampling for Multi-Armed Bandit
        thompsonSample(successes, failures) {
          const alpha = successes + 1;
          const beta = failures + 1;
          // Beta distribution approximation
          let sum = 0;
          for (let i = 0; i < alpha; i++) sum += -Math.log(Math.random());
          let sum2 = 0;
          for (let i = 0; i < beta; i++) sum2 += -Math.log(Math.random());
          return sum / (sum + sum2);
        },

        selectVariantBandit(stats) {
          let bestScore = -1;
          let bestVariant = this.variants[0];

          for (const variant of this.variants) {
            const s = stats[variant.id] || { impressions: 0, conversions: 0 };
            const score = this.thompsonSample(s.conversions, s.impressions - s.conversions);
            if (score > bestScore) {
              bestScore = score;
              bestVariant = variant;
            }
          }
          return bestVariant;
        },

        selectVariantRandom() {
          const total = this.variants.reduce((sum, v) => sum + (v.weight || 1), 0);
          let r = Math.random() * total;
          for (const v of this.variants) {
            r -= v.weight || 1;
            if (r <= 0) return v;
          }
          return this.variants[0];
        },

        async init() {
          // First, discover available polymorphs
          await this.discoverPolymorphs();

          // Check for manual override
          const override = localStorage.getItem(this.STORAGE_KEYS.manualOverride);
          if (override) {
            console.log('[AB] Manual override:', override);
            this.currentVariant = this.variants.find(v => v.id === override) || this.variants[0];
            this.showBadge();
            return;
          }

          let data = this.getExperimentData();
          const visitorId = this.getVisitorId();

          if (!data) {
            data = {
              visitorId,
              experimentId: this.experimentId,
              assignedVariant: null,
              stats: {},
              createdAt: Date.now()
            };
          }

          // Check sticky assignment
          if (data.assignedVariant && data.visitorId === visitorId) {
            this.currentVariant = this.variants.find(v => v.id === data.assignedVariant);
            if (this.currentVariant) {
              console.log('[AB] Returning visitor:', this.currentVariant.id);
              this.trackImpression(data);
              this.maybeRedirect();
              this.showBadge();
              return;
            }
          }

          // New visitor - select variant
          const totalImpressions = Object.values(data.stats).reduce(
            (sum, s) => sum + (s.impressions || 0), 0
          );

          if (this.enableBandit && totalImpressions > this.explorationThreshold) {
            this.currentVariant = this.selectVariantBandit(data.stats);
            console.log('[AB] Bandit selected:', this.currentVariant.id);
          } else {
            this.currentVariant = this.selectVariantRandom();
            console.log('[AB] Random selected:', this.currentVariant.id);
          }

          data.assignedVariant = this.currentVariant.id;
          data.visitorId = visitorId;
          this.saveExperimentData(data);

          this.trackImpression(data);
          this.maybeRedirect();
          this.showBadge();
        },

        trackImpression(data) {
          if (!this.currentVariant) return;
          const id = this.currentVariant.id;
          if (!data.stats[id]) data.stats[id] = { impressions: 0, conversions: 0 };
          data.stats[id].impressions++;
          this.saveExperimentData(data);
        },

        trackConversion() {
          if (!this.currentVariant) return;
          const data = this.getExperimentData();
          if (!data) return;

          const id = this.currentVariant.id;
          if (!data.stats[id]) data.stats[id] = { impressions: 1, conversions: 0 };
          data.stats[id].conversions++;
          this.saveExperimentData(data);

          console.log('[AB] Conversion:', id);

          // Fire to analytics
          if (window.gtag) {
            window.gtag('event', 'ab_conversion', {
              experiment_id: this.experimentId,
              variant_id: id
            });
          }
          if (window.posthog) {
            window.posthog.capture('ab_conversion', {
              experiment_id: this.experimentId,
              variant_id: id
            });
          }
        },

        maybeRedirect() {
          if (!this.currentVariant || !this.currentVariant.slug) return;
          const path = window.location.pathname;

          // CRITICAL: Do not redirect the home page
          if (path === '/' || path === '/index.html') return;

          if (!path.includes('/polymorphs/')) {
            window.location.href = `/polymorphs/${this.currentVariant.slug}.html`;
          }
        },

        showBadge() {
          const badge = document.getElementById('abBadge');
          if (badge && this.currentVariant) {
            badge.textContent = `A/B: ${this.currentVariant.id}`;
            badge.classList.add('visible');
          }
        },

        setOverride(variantId) {
          if (variantId) {
            localStorage.setItem(this.STORAGE_KEYS.manualOverride, variantId);
          } else {
            localStorage.removeItem(this.STORAGE_KEYS.manualOverride);
          }
        },

        getStats() {
          const data = this.getExperimentData();
          return data ? data.stats : {};
        }
      };

      // Make ABTest available globally for sidebar integration
      window.ABTest = ABTest;

      // Initialize A/B test (async - discovers polymorphs from folder)
      ABTest.init().catch(err => console.warn('[AB] Init error:', err));

      // ============================================================
      // HUB FUNCTIONALITY
      // ============================================================
      const CONFIG = {
        user: 'chirag127',
        exclude: ['chirag127.github.io', 'chirag127', '.github'],
        perPage: 100,
        maxPages: 10
      };

      const CATEGORIES = {
        pdf: ['pdf', 'document', 'split', 'merge'],
        image: ['image', 'photo', 'png', 'jpg', 'svg', 'icon', 'blur', 'crop', 'resize', 'webp', 'heic'],
        media: ['video', 'audio', 'mp3', 'mp4', 'recorder', 'music', 'youtube', 'gif'],
        dev: ['json', 'xml', 'sql', 'html', 'css', 'js', 'git', 'uuid', 'formatter', 'lint', 'api', 'code', 'regex'],
        text: ['text', 'word', 'line', 'diff', 'sort', 'ascii', 'markdown', 'lorem', 'string'],
        math: ['math', 'calculator', 'algebra', 'geometry', 'statistics', 'equation'],
        finance: ['loan', 'mortgage', 'tax', 'salary', 'interest', 'investment', 'currency'],
        health: ['bmi', 'calorie', 'body', 'health', 'fitness', 'weight'],
        converter: ['convert', 'unit', 'length', 'weight', 'temperature', 'encoder', 'decoder'],
        security: ['password', 'hash', 'encrypt', 'decrypt', 'md5', 'sha'],
        game: ['game', 'puzzle', 'play', 'sudoku', 'wordle', 'dice', 'random']
      };

      const ICONS = {
        pdf: 'üìÑ', image: 'üñºÔ∏è', media: '‚èØÔ∏è', dev: 'üõ†Ô∏è', text: 'üìù',
        math: 'üßÆ', finance: 'üí∞', health: '‚ù§Ô∏è', converter: 'üîÑ',
        security: 'üîí', game: 'üéÆ', other: '‚ö°'
      };

      let allRepos = [];
      let currentCategory = 'all';

      function detectCategory(text) {
        const lower = text.toLowerCase();
        for (const [cat, keywords] of Object.entries(CATEGORIES)) {
          if (keywords.some(kw => lower.includes(kw))) return cat;
        }
        return 'other';
      }

      async function fetchAllRepos() {
        const repos = [];
        let page = 1;

        while (page <= CONFIG.maxPages) {
          try {
            const response = await fetch(
              `https://api.github.com/users/${CONFIG.user}/repos?per_page=${CONFIG.perPage}&page=${page}&sort=pushed`
            );
            if (!response.ok) break;
            const data = await response.json();
            if (!data.length) break;
            repos.push(...data);
            page++;
          } catch (error) {
            console.error('Fetch error:', error);
            break;
          }
        }
        return repos;
      }

      function processRepos(rawRepos) {
        return rawRepos
          .filter(repo => !repo.fork && !CONFIG.exclude.includes(repo.name))
          .map(repo => {
            const combinedText = `${repo.name} ${repo.description || ''} ${(repo.topics || []).join(' ')}`;
            const category = detectCategory(combinedText);

            return {
              name: repo.name,
              title: repo.name.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase()),
              description: repo.description || 'A privacy-focused browser tool.',
              pagesUrl: repo.has_pages ? `/${repo.name}/` : null,
              repoUrl: repo.html_url,
              hasPages: repo.has_pages,
              stars: repo.stargazers_count,
              updated: new Date(repo.pushed_at).toLocaleDateString('en-US', { month: 'short', day: 'numeric' }),
              category: category
            };
          });
      }

      function renderTools(tools) {
        const grid = document.getElementById('toolsGrid');
        const countEl = document.getElementById('resultCount');

        countEl.textContent = `${tools.length}`;

        if (!tools.length) {
          grid.innerHTML = '<div class="state-msg"><p>No websites found matching your criteria.</p></div>';
          return;
        }

        grid.innerHTML = tools.map(tool => {
          const primaryHref = tool.hasPages ? tool.pagesUrl : tool.repoUrl;
          const primaryText = tool.hasPages ? 'üöÄ Open Website' : 'üíª View Repo';
          const primaryTarget = tool.hasPages ? '' : 'target="_blank" rel="noopener"';

          const secondaryBtn = tool.hasPages
            ? `<a href="${tool.repoUrl}" class="action-btn secondary" target="_blank" rel="noopener">üíª GitHub</a>`
            : '';

          return `
            <div class="tool-card" data-tool="${tool.name}">
              <div class="card-header">
                <div class="tool-icon-box">${ICONS[tool.category] || ICONS.other}</div>
                <div class="tool-info">
                  <div class="tool-title">${tool.title}</div>
                  <div class="tool-badge">${tool.category}</div>
                </div>
              </div>
              <div class="tool-desc">${tool.description}</div>
              <div class="tool-footer">
                <div class="stat-pill">‚≠ê ${tool.stars}</div>
                <div class="stat-pill">üìÖ ${tool.updated}</div>
              </div>
              <div class="card-actions">
                <a href="${primaryHref}" class="action-btn primary ab-track-btn" ${primaryTarget}>${primaryText}</a>
                ${secondaryBtn}
              </div>
            </div>
          `;
        }).join('');

        // Add conversion tracking to all action buttons
        document.querySelectorAll('.ab-track-btn').forEach(btn => {
          btn.addEventListener('click', () => {
            ABTest.trackConversion();
          });
        });
      }

      function filterAndRender() {
        const query = document.getElementById('searchInput').value.toLowerCase().trim();

        const filtered = allRepos.filter(repo => {
          const matchesSearch = !query ||
            repo.name.toLowerCase().includes(query) ||
            repo.title.toLowerCase().includes(query) ||
            repo.description.toLowerCase().includes(query);
          const matchesCategory = currentCategory === 'all' || repo.category === currentCategory;
          return matchesSearch && matchesCategory;
        });

        renderTools(filtered);
      }

      async function init() {
        try {
          const rawRepos = await fetchAllRepos();
          allRepos = processRepos(rawRepos);

          document.getElementById('toolCount').textContent = allRepos.length;
          filterAndRender();

          // Initialize polymorphs sidebar
          if (typeof Polymorphs !== 'undefined') {
            Polymorphs.init(POLYMORPHS_MODELS, {
              isHub: true,
              baseUrl: 'polymorphs',
              currentSlug: ''
            });
          }
        } catch (error) {
          console.error('Init error:', error);
          document.getElementById('toolsGrid').innerHTML = `
            <div class="state-msg">
              <p>Failed to load websites.</p>
              <button onclick="location.reload()" class="filter-btn" style="margin-top:1rem">Retry</button>
            </div>
          `;
        }
      }

      // Event listeners
      document.getElementById('searchInput').addEventListener('input', filterAndRender);

      document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          currentCategory = btn.dataset.cat;
          filterAndRender();
        });
      });

      // Polymorphs model data
      const POLYMORPHS_MODELS = [
        { name: "GLM 4.7 1T MoE Cerebras", slug: "glm-4-7-1t-moe-cerebras", size: 1000.0, provider: "Cerebras" },
        { name: "Mistral Large 3 675B Nvidia", slug: "mistral-large-3-675b-instruct-nvidia", size: 675.0, provider: "Nvidia" },
        { name: "Mistral Large 3 675B Mistral", slug: "mistral-large-3-675b-instruct-mistral", size: 675.0, provider: "Mistral" },
        { name: "DeepSeek R1T2 Chimera", slug: "deepseek-r1t2-chimera-openrouter", size: 671.0, provider: "OpenRouter" },
        { name: "DeepSeek V3.2 Nvidia", slug: "deepseek-v3-2-nvidia", size: 671.0, provider: "Nvidia" },
        { name: "Qwen3 Coder 480B MoE", slug: "qwen3-coder-480b-moe-openrouter", size: 480.0, provider: "OpenRouter" },
        { name: "R1T Chimera", slug: "r1t-chimera-openrouter", size: 450.0, provider: "OpenRouter" },
        { name: "Llama 3.1 405B GitHub", slug: "llama-3-1-405b-instruct-github", size: 405.0, provider: "GitHub" },
        { name: "MiMo V2 Flash 309B", slug: "mimo-v2-flash-309b-moe-openrouter", size: 309.0, provider: "OpenRouter" },
        { name: "Devstral 2 123B", slug: "devstral-2-123b-instruct-openrouter", size: 123.0, provider: "OpenRouter" },
        { name: "Devstral 2 123B Mistral", slug: "devstral-2-123b-mistral", size: 123.0, provider: "Mistral" },
        { name: "Llama 3.2 90B Vision", slug: "llama-3-2-90b-vision-instruct-groq", size: 90.0, provider: "Groq" },
        { name: "Mixtral 8x7B Instruct", slug: "mixtral-8x7b-instruct-groq", size: 56.0, provider: "Groq" },
        { name: "Qwen QwQ 32B", slug: "qwen-qwq-32b-groq", size: 32.0, provider: "Groq" },
        { name: "Qwen3 32B Cerebras", slug: "qwen3-32b-instruct-cerebras", size: 32.0, provider: "Cerebras" },
        { name: "Gemma 3 27B Gemini", slug: "gemma-3-27b-instruct-gemini", size: 27.0, provider: "Gemini" },
        { name: "GPT OSS 20B Cerebras", slug: "gpt-oss-20b-cerebras", size: 20.0, provider: "Cerebras" },
        { name: "GLM 4.5 Air", slug: "glm-4-5-air-openrouter", size: 20.0, provider: "OpenRouter" }
      ];

      // Start
      init();
    })();
  </script>
</body>

</html>