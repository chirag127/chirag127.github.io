name: Modify Existing Repositories

on:
  schedule:
    - cron: '0 6 * * *'  # Daily at 6 AM UTC
  workflow_dispatch:

# ALL API KEYS - Complete automation coverage
env:
  # === GITHUB ===
  GH_TOKEN: ${{ secrets.GH_TOKEN }}
  GH_USERNAME: chirag127

  # === PRIMARY AI PROVIDERS ===
  CEREBRAS_API_KEY: ${{ secrets.CEREBRAS_API_KEY }}
  GROQ_API_KEY: ${{ secrets.GROQ_API_KEY }}
  GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
  GEMINI_API_KEYS: ${{ secrets.GEMINI_API_KEYS }}

  # === BACKUP AI PROVIDERS ===
  MISTRAL_API_KEY: ${{ secrets.MISTRAL_API_KEY }}
  NVIDIA_API_KEY: ${{ secrets.NVIDIA_API_KEY }}
  CLOUDFLARE_API_TOKEN: ${{ secrets.CLOUDFLARE_API_TOKEN }}
  CLOUDFLARE_ACCOUNT_ID: ${{ secrets.CLOUDFLARE_ACCOUNT_ID }}

  # === TREND DISCOVERY APIS ===
  HF_TOKEN: ${{ secrets.HF_TOKEN }}
  KAGGLE_USERNAME: ${{ secrets.KAGGLE_USERNAME }}
  KAGGLE_KEY: ${{ secrets.KAGGLE_KEY }}

  # === SEARXNG (FREE SEARCH API) ===
  SEARXNG_URL: "https://searx.be/search"

jobs:
  modify:
    runs-on: ubuntu-latest
    timeout-minutes: 120

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.12'
          cache: 'pip'

      - name: Install dependencies
        run: pip install requests pydantic

      - name: Verify API Keys
        run: |
          echo "Verifying API keys..."
          [ -n "$GH_TOKEN" ] && echo "GH_TOKEN OK" || echo "GH_TOKEN missing"
          [ -n "$CEREBRAS_API_KEY" ] && echo "CEREBRAS_API_KEY OK" || echo "CEREBRAS_API_KEY missing"

      - name: Modify repositories
        run: python modify_existing_repositories.py
